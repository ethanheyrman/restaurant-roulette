{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.calculateFormValue = exports.shouldOmitFieldValue = exports.determineChangedValues = exports.getMissingItems = exports.joinDelimitedValue = exports.splitDelimitedValue = exports.updateFieldValue = exports.updateFieldTouchedState = exports.getFirstDefinedValue = exports.createField = exports.mapFieldsById = exports.processOptions = exports.shouldOptionsBeRefreshed = exports.processFields = exports.isRequired = exports.isDisabled = exports.isVisible = exports.evaluateAnyAndAllRules = exports.getTouchedStateForField = exports.evaluateSomeRules = exports.evaluateAllRules = exports.evaluateRule = exports.valuesMatch = exports.fieldDefIsValid = exports.setOptionsInFieldInState = exports.getNextStateFromFields = exports.registerFields = exports.registerField = undefined;\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _set = require(\"lodash/set\");\n\nvar _set2 = _interopRequireDefault(_set);\n\nvar _validation = require(\"../utilities/validation\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _toConsumableArray(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  } else {\n    return Array.from(arr);\n  }\n} // Because this function can be passed with the state of a component form\n// it is not mutating the supplied fields array but returning a new instance\n// each time, this is less efficient (when passing entire fieldDef arrays to the\n// form) but safer when children of forms are registering themselves\n\n\nvar registerField = exports.registerField = function registerField(field, fields, formValue) {\n  if (fieldDefIsValid(field, fields)) {\n    return fields.concat(field);\n  }\n\n  return fields.slice();\n};\n\nvar registerFields = exports.registerFields = function registerFields(fieldsToValidate, formValue) {\n  var fields = [];\n  fieldsToValidate.forEach(function (field) {\n    if (fieldDefIsValid(field, fields)) {\n      var defaultValue = field.defaultValue,\n          name = field.name,\n          value = field.value,\n          valueDelimiter = field.valueDelimiter;\n      var initialValue = getFirstDefinedValue(formValue[name], value, defaultValue);\n\n      var fieldToRegister = _extends({}, field, {\n        value: splitDelimitedValue(initialValue, valueDelimiter)\n      });\n\n      fields.push(fieldToRegister);\n    }\n  });\n  return fields;\n};\n\nvar getNextStateFromFields = exports.getNextStateFromFields = function getNextStateFromFields(_ref) {\n  var fields = _ref.fields,\n      lastFieldUpdated = _ref.lastFieldUpdated,\n      showValidationBeforeTouched = _ref.showValidationBeforeTouched,\n      formIsDisabled = _ref.formIsDisabled,\n      resetTouchedState = _ref.resetTouchedState,\n      optionsHandler = _ref.optionsHandler,\n      validationHandler = _ref.validationHandler,\n      parentContext = _ref.parentContext;\n  fields = processFields(fields, !!formIsDisabled, resetTouchedState);\n\n  if (optionsHandler) {\n    fields = processOptions({\n      fields: fields,\n      lastFieldUpdated: lastFieldUpdated,\n      optionsHandler: optionsHandler,\n      parentContext: parentContext\n    });\n  }\n\n  fields = (0, _validation.validateAllFields)({\n    fields: fields,\n    showValidationBeforeTouched: showValidationBeforeTouched,\n    validationHandler: validationHandler,\n    parentContext: parentContext\n  });\n  var value = calculateFormValue(fields);\n  var isValid = fields.every(function (field) {\n    return field.isValid;\n  });\n  var isDiscretelyInvalid = fields.some(function (field) {\n    return field.isDiscretelyInvalid;\n  });\n  var nextState = {\n    fields: fields,\n    value: value,\n    isValid: isValid && !isDiscretelyInvalid\n  };\n  return nextState;\n};\n\nvar setOptionsInFieldInState = exports.setOptionsInFieldInState = function setOptionsInFieldInState(prevState, field, options) {\n  var fieldIndex = prevState.fields.findIndex(function (prevField) {\n    return prevField.id === field.id;\n  });\n  field.options = options;\n  field.pendingOptions = undefined;\n  var prevFields = prevState.fields;\n  return {\n    fields: [].concat(_toConsumableArray(prevFields.slice(0, fieldIndex)), [field], _toConsumableArray(prevFields.slice(fieldIndex + 1)))\n  };\n}; // A field definition is valid if a field with the same id does not already exist in\n// the supplied form state.\n// We are assuming that typing takes care that all required attributes are present\n\n\nvar fieldDefIsValid = exports.fieldDefIsValid = function fieldDefIsValid(field, fields) {\n  return !fields.some(function (currentField) {\n    return currentField.id === field.id;\n  });\n};\n\nvar valuesMatch = exports.valuesMatch = function valuesMatch(a, b) {\n  if (a && b) {\n    return a.toString() === b.toString();\n  } else {\n    return a === b;\n  }\n};\n\nvar evaluateRule = exports.evaluateRule = function evaluateRule() {\n  var rule = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var targetValue = arguments[1];\n  var _rule$is = rule.is,\n      is = _rule$is === undefined ? [] : _rule$is,\n      _rule$isNot = rule.isNot,\n      isNot = _rule$isNot === undefined ? [] : _rule$isNot;\n  var hasValidValue = is.length === 0;\n  var hasInvalidValue = !!rule.isNot && rule.isNot.length > 0;\n\n  if (hasInvalidValue) {\n    hasInvalidValue = isNot.some(function (invalidValue) {\n      if (invalidValue.hasOwnProperty(\"value\")) {\n        return valuesMatch(invalidValue.value, targetValue);\n      } else {\n        return valuesMatch(invalidValue, targetValue);\n      }\n    });\n  }\n\n  if (!hasInvalidValue && !hasValidValue) {\n    if (rule.is && rule.is.length) {\n      hasValidValue = rule.is.some(function (validValue) {\n        if (validValue.hasOwnProperty(\"value\")) {\n          return valuesMatch(validValue.value, targetValue);\n        } else {\n          return valuesMatch(validValue, targetValue);\n        }\n      });\n    }\n  }\n\n  return hasValidValue && !hasInvalidValue;\n};\n\nvar evaluateAllRules = exports.evaluateAllRules = function evaluateAllRules(_ref2) {\n  var _ref2$rules = _ref2.rules,\n      rules = _ref2$rules === undefined ? [] : _ref2$rules,\n      _ref2$fieldsById = _ref2.fieldsById,\n      fieldsById = _ref2$fieldsById === undefined ? {} : _ref2$fieldsById,\n      _ref2$defaultResult = _ref2.defaultResult,\n      defaultResult = _ref2$defaultResult === undefined ? true : _ref2$defaultResult;\n  var rulesPass = defaultResult;\n\n  if (rules.length) {\n    rulesPass = rules.every(function (rule) {\n      if (rule.field && fieldsById.hasOwnProperty(rule.field)) {\n        return evaluateRule(rule, fieldsById[rule.field].value);\n      } else {\n        return defaultResult;\n      }\n    });\n  }\n\n  return rulesPass;\n};\n\nvar evaluateSomeRules = exports.evaluateSomeRules = function evaluateSomeRules(_ref3) {\n  var _ref3$rules = _ref3.rules,\n      rules = _ref3$rules === undefined ? [] : _ref3$rules,\n      _ref3$fieldsById = _ref3.fieldsById,\n      fieldsById = _ref3$fieldsById === undefined ? {} : _ref3$fieldsById,\n      _ref3$defaultResult = _ref3.defaultResult,\n      defaultResult = _ref3$defaultResult === undefined ? true : _ref3$defaultResult;\n  var rulesPass = defaultResult;\n\n  if (rules.length) {\n    rulesPass = rules.some(function (rule) {\n      if (rule.field && fieldsById.hasOwnProperty(rule.field)) {\n        return evaluateRule(rule, fieldsById[rule.field].value);\n      } else {\n        return defaultResult;\n      }\n    });\n  }\n\n  return rulesPass;\n};\n\nvar getTouchedStateForField = exports.getTouchedStateForField = function getTouchedStateForField(currentState, resetState) {\n  if (resetState === true) {\n    return false;\n  }\n\n  return currentState;\n};\n\nvar evaluateAnyAndAllRules = exports.evaluateAnyAndAllRules = function evaluateAnyAndAllRules(_ref4) {\n  var anyRules = _ref4.anyRules,\n      allRules = _ref4.allRules,\n      fieldsById = _ref4.fieldsById,\n      defaultResult = _ref4.defaultResult;\n\n  if (anyRules.length) {\n    return evaluateSomeRules({\n      rules: anyRules,\n      fieldsById: fieldsById,\n      defaultResult: defaultResult\n    });\n  }\n\n  if (allRules.length) {\n    return evaluateAllRules({\n      rules: allRules,\n      fieldsById: fieldsById,\n      defaultResult: defaultResult\n    });\n  }\n\n  return defaultResult;\n};\n\nvar isVisible = exports.isVisible = function isVisible(field, fieldsById) {\n  var visible = field.visible,\n      _field$visibleWhen = field.visibleWhen,\n      visibleWhen = _field$visibleWhen === undefined ? [] : _field$visibleWhen,\n      _field$visibleWhenAll = field.visibleWhenAll,\n      visibleWhenAll = _field$visibleWhenAll === undefined ? [] : _field$visibleWhenAll;\n  return evaluateAnyAndAllRules({\n    anyRules: visibleWhen,\n    allRules: visibleWhenAll,\n    fieldsById: fieldsById,\n    defaultResult: visible !== false\n  });\n};\n\nvar isDisabled = exports.isDisabled = function isDisabled(field, fieldsById) {\n  var defaultDisabled = field.defaultDisabled,\n      _field$disabledWhen = field.disabledWhen,\n      disabledWhen = _field$disabledWhen === undefined ? [] : _field$disabledWhen,\n      _field$disabledWhenAl = field.disabledWhenAll,\n      disabledWhenAll = _field$disabledWhenAl === undefined ? [] : _field$disabledWhenAl;\n  return evaluateAnyAndAllRules({\n    anyRules: disabledWhen,\n    allRules: disabledWhenAll,\n    fieldsById: fieldsById,\n    defaultResult: !!defaultDisabled\n  });\n};\n\nvar isRequired = exports.isRequired = function isRequired(field, fieldsById) {\n  var required = field.required,\n      _field$requiredWhen = field.requiredWhen,\n      requiredWhen = _field$requiredWhen === undefined ? [] : _field$requiredWhen,\n      _field$requiredWhenAl = field.requiredWhenAll,\n      requiredWhenAll = _field$requiredWhenAl === undefined ? [] : _field$requiredWhenAl;\n  return evaluateAnyAndAllRules({\n    anyRules: requiredWhen,\n    allRules: requiredWhenAll,\n    fieldsById: fieldsById,\n    defaultResult: !!required\n  });\n};\n\nvar processFields = exports.processFields = function processFields(fields, formIsDisabled) {\n  var resetTouchedState = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n  var fieldsById = mapFieldsById(fields);\n  var updatedFields = fields.map(function (field) {\n    var defaultValue = field.defaultValue,\n        value = field.value,\n        trimValue = field.trimValue,\n        _field$touched = field.touched,\n        touched = _field$touched === undefined ? false : _field$touched;\n    var processedValue = typeof value !== \"undefined\" ? value : defaultValue;\n    return _extends({}, field, {\n      touched: getTouchedStateForField(touched, resetTouchedState),\n      value: processedValue,\n      visible: isVisible(field, fieldsById),\n      required: isRequired(field, fieldsById),\n      disabled: formIsDisabled || isDisabled(field, fieldsById)\n    });\n  });\n  return updatedFields;\n};\n\nvar shouldOptionsBeRefreshed = exports.shouldOptionsBeRefreshed = function shouldOptionsBeRefreshed(_ref5) {\n  var lastFieldUpdated = _ref5.lastFieldUpdated,\n      field = _ref5.field;\n  var refreshOptionsOnChangesTo = field.refreshOptionsOnChangesTo;\n\n  if (lastFieldUpdated && refreshOptionsOnChangesTo) {\n    return refreshOptionsOnChangesTo.indexOf(lastFieldUpdated) !== -1;\n  }\n\n  return false;\n};\n\nvar processOptions = exports.processOptions = function processOptions(_ref6) {\n  var fields = _ref6.fields,\n      lastFieldUpdated = _ref6.lastFieldUpdated,\n      optionsHandler = _ref6.optionsHandler,\n      parentContext = _ref6.parentContext;\n  return fields.map(function (field) {\n    var id = field.id,\n        options = field.options;\n\n    if (!options || shouldOptionsBeRefreshed({\n      lastFieldUpdated: lastFieldUpdated,\n      field: field\n    })) {\n      var handlerOptions = optionsHandler(id, fields, parentContext);\n\n      if (handlerOptions instanceof Promise) {\n        field.options = [];\n        field.pendingOptions = handlerOptions;\n      } else if (handlerOptions) {\n        field.options = handlerOptions;\n        field.pendingOptions = undefined;\n      }\n    }\n\n    return field;\n  });\n};\n\nvar mapFieldsById = exports.mapFieldsById = function mapFieldsById(fields) {\n  return fields.reduce(function (map, field) {\n    map[field.id] = field;\n    return map;\n  }, {});\n}; // NOTE: Just used for test purposes...\n// TODO: Move to test file...\n\n\nvar createField = exports.createField = function createField(field) {\n  var _field$id = field.id,\n      id = _field$id === undefined ? \"\" : _field$id,\n      _field$name = field.name,\n      name = _field$name === undefined ? \"\" : _field$name,\n      _field$type = field.type,\n      type = _field$type === undefined ? \"\" : _field$type,\n      _field$placeholder = field.placeholder,\n      placeholder = _field$placeholder === undefined ? \"\" : _field$placeholder,\n      _field$value = field.value,\n      value = _field$value === undefined ? undefined : _field$value,\n      _field$visible = field.visible,\n      visible = _field$visible === undefined ? true : _field$visible,\n      _field$required = field.required,\n      required = _field$required === undefined ? false : _field$required,\n      _field$disabled = field.disabled,\n      disabled = _field$disabled === undefined ? false : _field$disabled,\n      _field$visibleWhen2 = field.visibleWhen,\n      visibleWhen = _field$visibleWhen2 === undefined ? [] : _field$visibleWhen2,\n      _field$visibleWhenAll2 = field.visibleWhenAll,\n      visibleWhenAll = _field$visibleWhenAll2 === undefined ? [] : _field$visibleWhenAll2,\n      _field$requiredWhen2 = field.requiredWhen,\n      requiredWhen = _field$requiredWhen2 === undefined ? [] : _field$requiredWhen2,\n      _field$requiredWhenAl2 = field.requiredWhenAll,\n      requiredWhenAll = _field$requiredWhenAl2 === undefined ? [] : _field$requiredWhenAl2,\n      _field$disabledWhen2 = field.disabledWhen,\n      disabledWhen = _field$disabledWhen2 === undefined ? [] : _field$disabledWhen2,\n      _field$disabledWhenAl2 = field.disabledWhenAll,\n      disabledWhenAll = _field$disabledWhenAl2 === undefined ? [] : _field$disabledWhenAl2,\n      _field$validWhen = field.validWhen,\n      validWhen = _field$validWhen === undefined ? {} : _field$validWhen,\n      _field$isValid = field.isValid,\n      isValid = _field$isValid === undefined ? true : _field$isValid,\n      _field$errorMessages = field.errorMessages,\n      errorMessages = _field$errorMessages === undefined ? \"\" : _field$errorMessages,\n      _field$touched2 = field.touched,\n      touched = _field$touched2 === undefined ? false : _field$touched2;\n  return {\n    id: id,\n    name: name,\n    type: type,\n    placeholder: placeholder,\n    value: value,\n    visible: visible,\n    required: required,\n    disabled: disabled,\n    visibleWhen: visibleWhen,\n    visibleWhenAll: visibleWhenAll,\n    requiredWhen: requiredWhen,\n    requiredWhenAll: requiredWhenAll,\n    disabledWhen: disabledWhen,\n    disabledWhenAll: disabledWhenAll,\n    isValid: isValid,\n    validWhen: validWhen,\n    errorMessages: errorMessages,\n    touched: touched\n  };\n};\n\nvar getFirstDefinedValue = exports.getFirstDefinedValue = function getFirstDefinedValue() {\n  for (var _len = arguments.length, values = Array(_len), _key = 0; _key < _len; _key++) {\n    values[_key] = arguments[_key];\n  }\n\n  var valueToReturn = void 0;\n  values.some(function (value) {\n    if (typeof value !== \"undefined\") {\n      valueToReturn = value;\n      return true;\n    }\n\n    return false;\n  });\n  return valueToReturn;\n};\n\nvar updateFieldTouchedState = exports.updateFieldTouchedState = function updateFieldTouchedState(id, touched, fields) {\n  var fieldsById = mapFieldsById(fields);\n  var field = fieldsById[id];\n  field.touched = touched;\n  return fields;\n};\n\nvar updateFieldValue = exports.updateFieldValue = function updateFieldValue(id, value, fields) {\n  var fieldsById = mapFieldsById(fields);\n  var updateValue = typeof value !== \"undefined\" && value;\n  var field = fieldsById[id];\n\n  if (field.omitWhenHidden && !field.visible) {\n    console.log(\"Not updating field value for\", field);\n  } else {\n    field.value = updateValue;\n  }\n\n  return fields;\n};\n\nvar splitDelimitedValue = exports.splitDelimitedValue = function splitDelimitedValue(value, valueDelimiter) {\n  if (valueDelimiter) {\n    if (typeof value === \"string\") {\n      value = value.split(valueDelimiter);\n    } else if (!Array.isArray(value)) {\n      value = [];\n    }\n  }\n\n  return value;\n};\n\nvar joinDelimitedValue = exports.joinDelimitedValue = function joinDelimitedValue(value, valueDelimiter) {\n  if (Array.isArray(value) && valueDelimiter) {\n    value = value.join(valueDelimiter);\n  }\n\n  return value;\n};\n\nvar getMissingItems = exports.getMissingItems = function getMissingItems(missingFrom, foundIn) {\n  return foundIn.reduce(function (missingItems, item) {\n    !missingFrom.includes(item) && missingItems.push(item);\n    return missingItems;\n  }, []);\n};\n\nvar determineChangedValues = exports.determineChangedValues = function determineChangedValues(field) {\n  var name = field.name,\n      defaultValue = field.defaultValue,\n      value = field.value,\n      valueDelimiter = field.valueDelimiter,\n      _field$addedSuffix = field.addedSuffix,\n      addedSuffix = _field$addedSuffix === undefined ? \"_added\" : _field$addedSuffix,\n      _field$removedSuffix = field.removedSuffix,\n      removedSuffix = _field$removedSuffix === undefined ? \"_removed\" : _field$removedSuffix;\n  var outputValues = [];\n  var initialValue = splitDelimitedValue(defaultValue, valueDelimiter);\n\n  if (Array.isArray(initialValue) && Array.isArray(value)) {\n    var added = getMissingItems(initialValue, value);\n    var removed = getMissingItems(value, initialValue);\n    added = joinDelimitedValue(added, valueDelimiter);\n    removed = joinDelimitedValue(removed, valueDelimiter);\n    outputValues.push({\n      name: name + (addedSuffix || \"_added\"),\n      value: added\n    }, {\n      name: name + (removedSuffix || \"_removed\"),\n      value: removed\n    });\n  }\n\n  return outputValues;\n};\n\nvar shouldOmitFieldValue = exports.shouldOmitFieldValue = function shouldOmitFieldValue(field) {\n  var omitWhenHidden = field.omitWhenHidden,\n      _field$omitWhenValueI = field.omitWhenValueIs,\n      omitWhenValueIs = _field$omitWhenValueI === undefined ? [] : _field$omitWhenValueI,\n      visible = field.visible,\n      value = field.value;\n  return omitWhenHidden && !visible || omitWhenValueIs.length !== 0 && omitWhenValueIs.some(function (currValue) {\n    return value === currValue;\n  });\n};\n\nvar calculateFormValue = exports.calculateFormValue = function calculateFormValue(fields) {\n  return fields.reduce(function (formValue, field) {\n    var name = field.name,\n        value = field.value,\n        trimValue = field.trimValue,\n        useChangesAsValues = field.useChangesAsValues;\n\n    if (shouldOmitFieldValue(field)) {\n      return formValue;\n    } else if (useChangesAsValues) {\n      determineChangedValues(field).forEach(function (_ref7) {\n        var name = _ref7.name,\n            value = _ref7.value;\n        return (0, _set2.default)(formValue, name, value);\n      });\n    } else {\n      var processedValue = value;\n\n      if (trimValue && processedValue && typeof processedValue.trim === \"function\") {\n        processedValue = processedValue.trim();\n      }\n\n      (0, _set2.default)(formValue, name, processedValue);\n    }\n\n    return formValue;\n  }, {});\n};","map":{"version":3,"sources":["/Users/niharikatomar/Desktop/rr/restaurant-roulette/frontend/node_modules/react-forms-processor/dist/utilities/utils.js"],"names":["Object","defineProperty","exports","value","calculateFormValue","shouldOmitFieldValue","determineChangedValues","getMissingItems","joinDelimitedValue","splitDelimitedValue","updateFieldValue","updateFieldTouchedState","getFirstDefinedValue","createField","mapFieldsById","processOptions","shouldOptionsBeRefreshed","processFields","isRequired","isDisabled","isVisible","evaluateAnyAndAllRules","getTouchedStateForField","evaluateSomeRules","evaluateAllRules","evaluateRule","valuesMatch","fieldDefIsValid","setOptionsInFieldInState","getNextStateFromFields","registerFields","registerField","undefined","_extends","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","_set","require","_set2","_interopRequireDefault","_validation","obj","__esModule","default","_toConsumableArray","arr","Array","isArray","arr2","from","field","fields","formValue","concat","slice","fieldsToValidate","forEach","defaultValue","name","valueDelimiter","initialValue","fieldToRegister","push","_ref","lastFieldUpdated","showValidationBeforeTouched","formIsDisabled","resetTouchedState","optionsHandler","validationHandler","parentContext","validateAllFields","isValid","every","isDiscretelyInvalid","some","nextState","prevState","options","fieldIndex","findIndex","prevField","id","pendingOptions","prevFields","currentField","a","b","toString","rule","targetValue","_rule$is","is","_rule$isNot","isNot","hasValidValue","hasInvalidValue","invalidValue","validValue","_ref2","_ref2$rules","rules","_ref2$fieldsById","fieldsById","_ref2$defaultResult","defaultResult","rulesPass","_ref3","_ref3$rules","_ref3$fieldsById","_ref3$defaultResult","currentState","resetState","_ref4","anyRules","allRules","visible","_field$visibleWhen","visibleWhen","_field$visibleWhenAll","visibleWhenAll","defaultDisabled","_field$disabledWhen","disabledWhen","_field$disabledWhenAl","disabledWhenAll","required","_field$requiredWhen","requiredWhen","_field$requiredWhenAl","requiredWhenAll","updatedFields","map","trimValue","_field$touched","touched","processedValue","disabled","_ref5","refreshOptionsOnChangesTo","indexOf","_ref6","handlerOptions","Promise","reduce","_field$id","_field$name","_field$type","type","_field$placeholder","placeholder","_field$value","_field$visible","_field$required","_field$disabled","_field$visibleWhen2","_field$visibleWhenAll2","_field$requiredWhen2","_field$requiredWhenAl2","_field$disabledWhen2","_field$disabledWhenAl2","_field$validWhen","validWhen","_field$isValid","_field$errorMessages","errorMessages","_field$touched2","_len","values","_key","valueToReturn","updateValue","omitWhenHidden","console","log","split","join","missingFrom","foundIn","missingItems","item","includes","_field$addedSuffix","addedSuffix","_field$removedSuffix","removedSuffix","outputValues","added","removed","_field$omitWhenValueI","omitWhenValueIs","currValue","useChangesAsValues","_ref7","trim"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.calculateFormValue = exports.shouldOmitFieldValue = exports.determineChangedValues = exports.getMissingItems = exports.joinDelimitedValue = exports.splitDelimitedValue = exports.updateFieldValue = exports.updateFieldTouchedState = exports.getFirstDefinedValue = exports.createField = exports.mapFieldsById = exports.processOptions = exports.shouldOptionsBeRefreshed = exports.processFields = exports.isRequired = exports.isDisabled = exports.isVisible = exports.evaluateAnyAndAllRules = exports.getTouchedStateForField = exports.evaluateSomeRules = exports.evaluateAllRules = exports.evaluateRule = exports.valuesMatch = exports.fieldDefIsValid = exports.setOptionsInFieldInState = exports.getNextStateFromFields = exports.registerFields = exports.registerField = undefined;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _set = require(\"lodash/set\");\n\nvar _set2 = _interopRequireDefault(_set);\n\nvar _validation = require(\"../utilities/validation\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\n// Because this function can be passed with the state of a component form\n// it is not mutating the supplied fields array but returning a new instance\n// each time, this is less efficient (when passing entire fieldDef arrays to the\n// form) but safer when children of forms are registering themselves\nvar registerField = exports.registerField = function registerField(field, fields, formValue) {\n  if (fieldDefIsValid(field, fields)) {\n    return fields.concat(field);\n  }\n  return fields.slice();\n};\n\nvar registerFields = exports.registerFields = function registerFields(fieldsToValidate, formValue) {\n  var fields = [];\n  fieldsToValidate.forEach(function (field) {\n    if (fieldDefIsValid(field, fields)) {\n      var defaultValue = field.defaultValue,\n          name = field.name,\n          value = field.value,\n          valueDelimiter = field.valueDelimiter;\n\n      var initialValue = getFirstDefinedValue(formValue[name], value, defaultValue);\n\n      var fieldToRegister = _extends({}, field, {\n        value: splitDelimitedValue(initialValue, valueDelimiter)\n      });\n      fields.push(fieldToRegister);\n    }\n  });\n  return fields;\n};\n\nvar getNextStateFromFields = exports.getNextStateFromFields = function getNextStateFromFields(_ref) {\n  var fields = _ref.fields,\n      lastFieldUpdated = _ref.lastFieldUpdated,\n      showValidationBeforeTouched = _ref.showValidationBeforeTouched,\n      formIsDisabled = _ref.formIsDisabled,\n      resetTouchedState = _ref.resetTouchedState,\n      optionsHandler = _ref.optionsHandler,\n      validationHandler = _ref.validationHandler,\n      parentContext = _ref.parentContext;\n\n  fields = processFields(fields, !!formIsDisabled, resetTouchedState);\n  if (optionsHandler) {\n    fields = processOptions({\n      fields: fields,\n      lastFieldUpdated: lastFieldUpdated,\n      optionsHandler: optionsHandler,\n      parentContext: parentContext\n    });\n  }\n\n  fields = (0, _validation.validateAllFields)({\n    fields: fields,\n    showValidationBeforeTouched: showValidationBeforeTouched,\n    validationHandler: validationHandler,\n    parentContext: parentContext\n  });\n\n  var value = calculateFormValue(fields);\n  var isValid = fields.every(function (field) {\n    return field.isValid;\n  });\n  var isDiscretelyInvalid = fields.some(function (field) {\n    return field.isDiscretelyInvalid;\n  });\n  var nextState = {\n    fields: fields,\n    value: value,\n    isValid: isValid && !isDiscretelyInvalid\n  };\n  return nextState;\n};\n\nvar setOptionsInFieldInState = exports.setOptionsInFieldInState = function setOptionsInFieldInState(prevState, field, options) {\n  var fieldIndex = prevState.fields.findIndex(function (prevField) {\n    return prevField.id === field.id;\n  });\n\n  field.options = options;\n  field.pendingOptions = undefined;\n\n  var prevFields = prevState.fields;\n\n  return {\n    fields: [].concat(_toConsumableArray(prevFields.slice(0, fieldIndex)), [field], _toConsumableArray(prevFields.slice(fieldIndex + 1)))\n  };\n};\n\n// A field definition is valid if a field with the same id does not already exist in\n// the supplied form state.\n// We are assuming that typing takes care that all required attributes are present\nvar fieldDefIsValid = exports.fieldDefIsValid = function fieldDefIsValid(field, fields) {\n  return !fields.some(function (currentField) {\n    return currentField.id === field.id;\n  });\n};\n\nvar valuesMatch = exports.valuesMatch = function valuesMatch(a, b) {\n  if (a && b) {\n    return a.toString() === b.toString();\n  } else {\n    return a === b;\n  }\n};\n\nvar evaluateRule = exports.evaluateRule = function evaluateRule() {\n  var rule = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var targetValue = arguments[1];\n  var _rule$is = rule.is,\n      is = _rule$is === undefined ? [] : _rule$is,\n      _rule$isNot = rule.isNot,\n      isNot = _rule$isNot === undefined ? [] : _rule$isNot;\n\n  var hasValidValue = is.length === 0;\n  var hasInvalidValue = !!rule.isNot && rule.isNot.length > 0;\n\n  if (hasInvalidValue) {\n    hasInvalidValue = isNot.some(function (invalidValue) {\n      if (invalidValue.hasOwnProperty(\"value\")) {\n        return valuesMatch(invalidValue.value, targetValue);\n      } else {\n        return valuesMatch(invalidValue, targetValue);\n      }\n    });\n  }\n\n  if (!hasInvalidValue && !hasValidValue) {\n    if (rule.is && rule.is.length) {\n      hasValidValue = rule.is.some(function (validValue) {\n        if (validValue.hasOwnProperty(\"value\")) {\n          return valuesMatch(validValue.value, targetValue);\n        } else {\n          return valuesMatch(validValue, targetValue);\n        }\n      });\n    }\n  }\n  return hasValidValue && !hasInvalidValue;\n};\n\nvar evaluateAllRules = exports.evaluateAllRules = function evaluateAllRules(_ref2) {\n  var _ref2$rules = _ref2.rules,\n      rules = _ref2$rules === undefined ? [] : _ref2$rules,\n      _ref2$fieldsById = _ref2.fieldsById,\n      fieldsById = _ref2$fieldsById === undefined ? {} : _ref2$fieldsById,\n      _ref2$defaultResult = _ref2.defaultResult,\n      defaultResult = _ref2$defaultResult === undefined ? true : _ref2$defaultResult;\n\n  var rulesPass = defaultResult;\n  if (rules.length) {\n    rulesPass = rules.every(function (rule) {\n      if (rule.field && fieldsById.hasOwnProperty(rule.field)) {\n        return evaluateRule(rule, fieldsById[rule.field].value);\n      } else {\n        return defaultResult;\n      }\n    });\n  }\n  return rulesPass;\n};\n\nvar evaluateSomeRules = exports.evaluateSomeRules = function evaluateSomeRules(_ref3) {\n  var _ref3$rules = _ref3.rules,\n      rules = _ref3$rules === undefined ? [] : _ref3$rules,\n      _ref3$fieldsById = _ref3.fieldsById,\n      fieldsById = _ref3$fieldsById === undefined ? {} : _ref3$fieldsById,\n      _ref3$defaultResult = _ref3.defaultResult,\n      defaultResult = _ref3$defaultResult === undefined ? true : _ref3$defaultResult;\n\n  var rulesPass = defaultResult;\n  if (rules.length) {\n    rulesPass = rules.some(function (rule) {\n      if (rule.field && fieldsById.hasOwnProperty(rule.field)) {\n        return evaluateRule(rule, fieldsById[rule.field].value);\n      } else {\n        return defaultResult;\n      }\n    });\n  }\n  return rulesPass;\n};\n\nvar getTouchedStateForField = exports.getTouchedStateForField = function getTouchedStateForField(currentState, resetState) {\n  if (resetState === true) {\n    return false;\n  }\n  return currentState;\n};\n\nvar evaluateAnyAndAllRules = exports.evaluateAnyAndAllRules = function evaluateAnyAndAllRules(_ref4) {\n  var anyRules = _ref4.anyRules,\n      allRules = _ref4.allRules,\n      fieldsById = _ref4.fieldsById,\n      defaultResult = _ref4.defaultResult;\n\n  if (anyRules.length) {\n    return evaluateSomeRules({\n      rules: anyRules,\n      fieldsById: fieldsById,\n      defaultResult: defaultResult\n    });\n  }\n  if (allRules.length) {\n    return evaluateAllRules({\n      rules: allRules,\n      fieldsById: fieldsById,\n      defaultResult: defaultResult\n    });\n  }\n  return defaultResult;\n};\n\nvar isVisible = exports.isVisible = function isVisible(field, fieldsById) {\n  var visible = field.visible,\n      _field$visibleWhen = field.visibleWhen,\n      visibleWhen = _field$visibleWhen === undefined ? [] : _field$visibleWhen,\n      _field$visibleWhenAll = field.visibleWhenAll,\n      visibleWhenAll = _field$visibleWhenAll === undefined ? [] : _field$visibleWhenAll;\n\n  return evaluateAnyAndAllRules({\n    anyRules: visibleWhen,\n    allRules: visibleWhenAll,\n    fieldsById: fieldsById,\n    defaultResult: visible !== false\n  });\n};\n\nvar isDisabled = exports.isDisabled = function isDisabled(field, fieldsById) {\n  var defaultDisabled = field.defaultDisabled,\n      _field$disabledWhen = field.disabledWhen,\n      disabledWhen = _field$disabledWhen === undefined ? [] : _field$disabledWhen,\n      _field$disabledWhenAl = field.disabledWhenAll,\n      disabledWhenAll = _field$disabledWhenAl === undefined ? [] : _field$disabledWhenAl;\n\n  return evaluateAnyAndAllRules({\n    anyRules: disabledWhen,\n    allRules: disabledWhenAll,\n    fieldsById: fieldsById,\n    defaultResult: !!defaultDisabled\n  });\n};\n\nvar isRequired = exports.isRequired = function isRequired(field, fieldsById) {\n  var required = field.required,\n      _field$requiredWhen = field.requiredWhen,\n      requiredWhen = _field$requiredWhen === undefined ? [] : _field$requiredWhen,\n      _field$requiredWhenAl = field.requiredWhenAll,\n      requiredWhenAll = _field$requiredWhenAl === undefined ? [] : _field$requiredWhenAl;\n\n  return evaluateAnyAndAllRules({\n    anyRules: requiredWhen,\n    allRules: requiredWhenAll,\n    fieldsById: fieldsById,\n    defaultResult: !!required\n  });\n};\n\nvar processFields = exports.processFields = function processFields(fields, formIsDisabled) {\n  var resetTouchedState = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\n  var fieldsById = mapFieldsById(fields);\n  var updatedFields = fields.map(function (field) {\n    var defaultValue = field.defaultValue,\n        value = field.value,\n        trimValue = field.trimValue,\n        _field$touched = field.touched,\n        touched = _field$touched === undefined ? false : _field$touched;\n\n\n    var processedValue = typeof value !== \"undefined\" ? value : defaultValue;\n\n    return _extends({}, field, {\n      touched: getTouchedStateForField(touched, resetTouchedState),\n      value: processedValue,\n      visible: isVisible(field, fieldsById),\n      required: isRequired(field, fieldsById),\n      disabled: formIsDisabled || isDisabled(field, fieldsById)\n    });\n  });\n  return updatedFields;\n};\n\nvar shouldOptionsBeRefreshed = exports.shouldOptionsBeRefreshed = function shouldOptionsBeRefreshed(_ref5) {\n  var lastFieldUpdated = _ref5.lastFieldUpdated,\n      field = _ref5.field;\n  var refreshOptionsOnChangesTo = field.refreshOptionsOnChangesTo;\n\n  if (lastFieldUpdated && refreshOptionsOnChangesTo) {\n    return refreshOptionsOnChangesTo.indexOf(lastFieldUpdated) !== -1;\n  }\n\n  return false;\n};\n\nvar processOptions = exports.processOptions = function processOptions(_ref6) {\n  var fields = _ref6.fields,\n      lastFieldUpdated = _ref6.lastFieldUpdated,\n      optionsHandler = _ref6.optionsHandler,\n      parentContext = _ref6.parentContext;\n\n  return fields.map(function (field) {\n    var id = field.id,\n        options = field.options;\n\n    if (!options || shouldOptionsBeRefreshed({ lastFieldUpdated: lastFieldUpdated, field: field })) {\n      var handlerOptions = optionsHandler(id, fields, parentContext);\n      if (handlerOptions instanceof Promise) {\n        field.options = [];\n        field.pendingOptions = handlerOptions;\n      } else if (handlerOptions) {\n        field.options = handlerOptions;\n        field.pendingOptions = undefined;\n      }\n    }\n    return field;\n  });\n};\n\nvar mapFieldsById = exports.mapFieldsById = function mapFieldsById(fields) {\n  return fields.reduce(function (map, field) {\n    map[field.id] = field;\n    return map;\n  }, {});\n};\n\n// NOTE: Just used for test purposes...\n// TODO: Move to test file...\nvar createField = exports.createField = function createField(field) {\n  var _field$id = field.id,\n      id = _field$id === undefined ? \"\" : _field$id,\n      _field$name = field.name,\n      name = _field$name === undefined ? \"\" : _field$name,\n      _field$type = field.type,\n      type = _field$type === undefined ? \"\" : _field$type,\n      _field$placeholder = field.placeholder,\n      placeholder = _field$placeholder === undefined ? \"\" : _field$placeholder,\n      _field$value = field.value,\n      value = _field$value === undefined ? undefined : _field$value,\n      _field$visible = field.visible,\n      visible = _field$visible === undefined ? true : _field$visible,\n      _field$required = field.required,\n      required = _field$required === undefined ? false : _field$required,\n      _field$disabled = field.disabled,\n      disabled = _field$disabled === undefined ? false : _field$disabled,\n      _field$visibleWhen2 = field.visibleWhen,\n      visibleWhen = _field$visibleWhen2 === undefined ? [] : _field$visibleWhen2,\n      _field$visibleWhenAll2 = field.visibleWhenAll,\n      visibleWhenAll = _field$visibleWhenAll2 === undefined ? [] : _field$visibleWhenAll2,\n      _field$requiredWhen2 = field.requiredWhen,\n      requiredWhen = _field$requiredWhen2 === undefined ? [] : _field$requiredWhen2,\n      _field$requiredWhenAl2 = field.requiredWhenAll,\n      requiredWhenAll = _field$requiredWhenAl2 === undefined ? [] : _field$requiredWhenAl2,\n      _field$disabledWhen2 = field.disabledWhen,\n      disabledWhen = _field$disabledWhen2 === undefined ? [] : _field$disabledWhen2,\n      _field$disabledWhenAl2 = field.disabledWhenAll,\n      disabledWhenAll = _field$disabledWhenAl2 === undefined ? [] : _field$disabledWhenAl2,\n      _field$validWhen = field.validWhen,\n      validWhen = _field$validWhen === undefined ? {} : _field$validWhen,\n      _field$isValid = field.isValid,\n      isValid = _field$isValid === undefined ? true : _field$isValid,\n      _field$errorMessages = field.errorMessages,\n      errorMessages = _field$errorMessages === undefined ? \"\" : _field$errorMessages,\n      _field$touched2 = field.touched,\n      touched = _field$touched2 === undefined ? false : _field$touched2;\n\n  return {\n    id: id,\n    name: name,\n    type: type,\n    placeholder: placeholder,\n    value: value,\n    visible: visible,\n    required: required,\n    disabled: disabled,\n    visibleWhen: visibleWhen,\n    visibleWhenAll: visibleWhenAll,\n    requiredWhen: requiredWhen,\n    requiredWhenAll: requiredWhenAll,\n    disabledWhen: disabledWhen,\n    disabledWhenAll: disabledWhenAll,\n    isValid: isValid,\n    validWhen: validWhen,\n    errorMessages: errorMessages,\n    touched: touched\n  };\n};\n\nvar getFirstDefinedValue = exports.getFirstDefinedValue = function getFirstDefinedValue() {\n  for (var _len = arguments.length, values = Array(_len), _key = 0; _key < _len; _key++) {\n    values[_key] = arguments[_key];\n  }\n\n  var valueToReturn = void 0;\n  values.some(function (value) {\n    if (typeof value !== \"undefined\") {\n      valueToReturn = value;\n      return true;\n    }\n    return false;\n  });\n  return valueToReturn;\n};\n\nvar updateFieldTouchedState = exports.updateFieldTouchedState = function updateFieldTouchedState(id, touched, fields) {\n  var fieldsById = mapFieldsById(fields);\n  var field = fieldsById[id];\n  field.touched = touched;\n  return fields;\n};\n\nvar updateFieldValue = exports.updateFieldValue = function updateFieldValue(id, value, fields) {\n  var fieldsById = mapFieldsById(fields);\n  var updateValue = typeof value !== \"undefined\" && value;\n  var field = fieldsById[id];\n  if (field.omitWhenHidden && !field.visible) {\n    console.log(\"Not updating field value for\", field);\n  } else {\n    field.value = updateValue;\n  }\n  return fields;\n};\n\nvar splitDelimitedValue = exports.splitDelimitedValue = function splitDelimitedValue(value, valueDelimiter) {\n  if (valueDelimiter) {\n    if (typeof value === \"string\") {\n      value = value.split(valueDelimiter);\n    } else if (!Array.isArray(value)) {\n      value = [];\n    }\n  }\n  return value;\n};\n\nvar joinDelimitedValue = exports.joinDelimitedValue = function joinDelimitedValue(value, valueDelimiter) {\n  if (Array.isArray(value) && valueDelimiter) {\n    value = value.join(valueDelimiter);\n  }\n  return value;\n};\n\nvar getMissingItems = exports.getMissingItems = function getMissingItems(missingFrom, foundIn) {\n  return foundIn.reduce(function (missingItems, item) {\n    !missingFrom.includes(item) && missingItems.push(item);\n    return missingItems;\n  }, []);\n};\n\nvar determineChangedValues = exports.determineChangedValues = function determineChangedValues(field) {\n  var name = field.name,\n      defaultValue = field.defaultValue,\n      value = field.value,\n      valueDelimiter = field.valueDelimiter,\n      _field$addedSuffix = field.addedSuffix,\n      addedSuffix = _field$addedSuffix === undefined ? \"_added\" : _field$addedSuffix,\n      _field$removedSuffix = field.removedSuffix,\n      removedSuffix = _field$removedSuffix === undefined ? \"_removed\" : _field$removedSuffix;\n\n  var outputValues = [];\n\n  var initialValue = splitDelimitedValue(defaultValue, valueDelimiter);\n  if (Array.isArray(initialValue) && Array.isArray(value)) {\n    var added = getMissingItems(initialValue, value);\n    var removed = getMissingItems(value, initialValue);\n\n    added = joinDelimitedValue(added, valueDelimiter);\n    removed = joinDelimitedValue(removed, valueDelimiter);\n\n    outputValues.push({\n      name: name + (addedSuffix || \"_added\"),\n      value: added\n    }, {\n      name: name + (removedSuffix || \"_removed\"),\n      value: removed\n    });\n  }\n  return outputValues;\n};\n\nvar shouldOmitFieldValue = exports.shouldOmitFieldValue = function shouldOmitFieldValue(field) {\n  var omitWhenHidden = field.omitWhenHidden,\n      _field$omitWhenValueI = field.omitWhenValueIs,\n      omitWhenValueIs = _field$omitWhenValueI === undefined ? [] : _field$omitWhenValueI,\n      visible = field.visible,\n      value = field.value;\n\n  return omitWhenHidden && !visible || omitWhenValueIs.length !== 0 && omitWhenValueIs.some(function (currValue) {\n    return value === currValue;\n  });\n};\n\nvar calculateFormValue = exports.calculateFormValue = function calculateFormValue(fields) {\n  return fields.reduce(function (formValue, field) {\n    var name = field.name,\n        value = field.value,\n        trimValue = field.trimValue,\n        useChangesAsValues = field.useChangesAsValues;\n\n    if (shouldOmitFieldValue(field)) {\n      return formValue;\n    } else if (useChangesAsValues) {\n      determineChangedValues(field).forEach(function (_ref7) {\n        var name = _ref7.name,\n            value = _ref7.value;\n        return (0, _set2.default)(formValue, name, value);\n      });\n    } else {\n      var processedValue = value;\n      if (trimValue && processedValue && typeof processedValue.trim === \"function\") {\n        processedValue = processedValue.trim();\n      }\n      (0, _set2.default)(formValue, name, processedValue);\n    }\n\n    return formValue;\n  }, {});\n};"]},"metadata":{},"sourceType":"script"}