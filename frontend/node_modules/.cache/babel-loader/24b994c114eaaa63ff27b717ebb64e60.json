{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _react = require(\"react\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _isEqual = require(\"lodash/isEqual\");\n\nvar _isEqual2 = _interopRequireDefault(_isEqual);\n\nvar _FormContext = require(\"./FormContext\");\n\nvar _FormContext2 = _interopRequireDefault(_FormContext);\n\nvar _FormFragment = require(\"./FormFragment\");\n\nvar _FormFragment2 = _interopRequireDefault(_FormFragment);\n\nvar _DefaultField = require(\"./DefaultField\");\n\nvar _DefaultField2 = _interopRequireDefault(_DefaultField);\n\nvar _utils = require(\"../utilities/utils\");\n\nvar _renderer = require(\"../renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar defaultFieldsHaveChanged = function defaultFieldsHaveChanged(nextProps, prevState) {\n  return !(0, _isEqual2.default)(nextProps.defaultFields, prevState.defaultFields);\n};\n\nvar valueHasChanged = function valueHasChanged(nextProps, prevState) {\n  return nextProps.value && nextProps.value !== prevState.value;\n};\n\nvar defaultValueHasChanged = function defaultValueHasChanged(nextProps, prevState) {\n  return nextProps.value && nextProps.value !== prevState.defaultValue;\n};\n\nvar formDisabledStateHasChanged = function formDisabledStateHasChanged(nextProps, prevState) {\n  return nextProps.disabled !== undefined && nextProps.disabled !== prevState.disabled;\n};\n\nvar formTouchedBehaviourHasChanged = function formTouchedBehaviourHasChanged(nextProps, prevState) {\n  return nextProps.showValidationBeforeTouched !== prevState.showValidationBeforeTouched;\n};\n\nvar Form = function (_Component) {\n  _inherits(Form, _Component);\n\n  function Form(props) {\n    _classCallCheck(this, Form);\n\n    var _this = _possibleConstructorReturn(this, (Form.__proto__ || Object.getPrototypeOf(Form)).call(this, props));\n\n    _this.state = {\n      fields: [],\n      defaultValue: props.value || {},\n      value: props.value || {},\n      isValid: false,\n      defaultFields: [],\n      disabled: props.disabled || false,\n      showValidationBeforeTouched: !!props.showValidationBeforeTouched\n    };\n    return _this;\n  }\n\n  _createClass(Form, [{\n    key: \"shouldComponentUpdate\",\n    value: function shouldComponentUpdate(nextProps, nextState) {\n      var _props$conditionalUpd = this.props.conditionalUpdate,\n          conditionalUpdate = _props$conditionalUpd === undefined ? false : _props$conditionalUpd; // TODO: This might need some further thought, but it definitely improves performance in the FormBuilder\n\n      if (conditionalUpdate && nextProps.renderer === this.props.renderer && (0, _isEqual2.default)(this.state.fields, nextState.fields) && (0, _isEqual2.default)(this.state.value, nextState.value)) {\n        return false;\n      }\n\n      return true;\n    }\n  }, {\n    key: \"onFieldChange\",\n    value: function onFieldChange(id, value, skipFieldTouched) {\n      var _this2 = this;\n\n      var _props = this.props,\n          optionsHandler = _props.optionsHandler,\n          validationHandler = _props.validationHandler,\n          parentContext = _props.parentContext,\n          _props$showValidation = _props.showValidationBeforeTouched,\n          showValidationBeforeTouched = _props$showValidation === undefined ? false : _props$showValidation,\n          _props$disabled = _props.disabled,\n          disabled = _props$disabled === undefined ? false : _props$disabled;\n      var fields = this.state.fields; //skiping the field touch update here\n\n      if (!skipFieldTouched) {\n        fields = (0, _utils.updateFieldTouchedState)(id, true, fields);\n      }\n\n      fields = (0, _utils.updateFieldValue)(id, value, fields);\n      var nextState = (0, _utils.getNextStateFromFields)({\n        fields: fields,\n        lastFieldUpdated: id,\n        showValidationBeforeTouched: showValidationBeforeTouched,\n        formIsDisabled: disabled,\n        resetTouchedState: false,\n        optionsHandler: optionsHandler,\n        validationHandler: validationHandler,\n        parentContext: parentContext\n      });\n      this.setState(function (state, props) {\n        return nextState;\n      }, function () {\n        var onChange = _this2.props.onChange;\n        var value = nextState.value,\n            isValid = nextState.isValid;\n\n        if (onChange) {\n          onChange(value, isValid);\n        }\n      });\n    }\n  }, {\n    key: \"onFieldFocus\",\n    value: function onFieldFocus(id) {\n      // At one stage the plan was to only show validation error messages once a field\n      // had been touched, but in reality we only want to show validation messages when\n      // a field has been changed OR has been blurred.\n      // So now we just want to make sure that callbacks on the form for handling when\n      // a field is focused are called.\n      var onFieldFocusProp = this.props.onFieldFocus;\n      onFieldFocusProp && onFieldFocusProp(id);\n    }\n  }, {\n    key: \"onFieldBlur\",\n    value: function onFieldBlur(id) {\n      var _props2 = this.props,\n          optionsHandler = _props2.optionsHandler,\n          validationHandler = _props2.validationHandler,\n          onFieldBlurProp = _props2.onFieldBlur,\n          parentContext = _props2.parentContext,\n          _props2$showValidatio = _props2.showValidationBeforeTouched,\n          showValidationBeforeTouched = _props2$showValidatio === undefined ? false : _props2$showValidatio,\n          _props2$disabled = _props2.disabled,\n          disabled = _props2$disabled === undefined ? false : _props2$disabled;\n      var fields = this.state.fields;\n      fields = (0, _utils.updateFieldTouchedState)(id, true, fields);\n      var nextState = (0, _utils.getNextStateFromFields)({\n        fields: fields,\n        showValidationBeforeTouched: showValidationBeforeTouched,\n        formIsDisabled: disabled,\n        resetTouchedState: false,\n        optionsHandler: optionsHandler,\n        validationHandler: validationHandler,\n        parentContext: parentContext\n      });\n      this.setState(nextState, function () {\n        return onFieldBlurProp && onFieldBlurProp(id);\n      });\n    } // Register field is provided in the context to allow children to register with this form...\n\n  }, {\n    key: \"registerField\",\n    value: function registerField(field) {\n      var _state = this.state,\n          _state$fields = _state.fields,\n          fields = _state$fields === undefined ? [] : _state$fields,\n          _state$value = _state.value,\n          value = _state$value === undefined ? {} : _state$value;\n      var _props3 = this.props,\n          _props3$showValidatio = _props3.showValidationBeforeTouched,\n          showValidationBeforeTouched = _props3$showValidatio === undefined ? false : _props3$showValidatio,\n          _props3$disabled = _props3.disabled,\n          disabled = _props3$disabled === undefined ? false : _props3$disabled;\n\n      if (fields.find(function (existingField) {\n        return field.id === existingField.id;\n      })) {// Don't register fields twice...\n        // console.warn(\"Field ID already in use\", field.id);\n      } else {\n        fields = (0, _utils.registerField)(field, fields, value);\n        this.setState(function (state, props) {\n          var optionsHandler = props.optionsHandler,\n              validationHandler = props.validationHandler,\n              parentContext = props.parentContext;\n          var filteredFields = state.fields.filter(function (existingField) {\n            return existingField.id !== field.id;\n          }); // let updatedFields = fields.concat(filteredFields);\n\n          var updatedFields = filteredFields.concat(field);\n          var nextState = (0, _utils.getNextStateFromFields)({\n            fields: updatedFields,\n            showValidationBeforeTouched: showValidationBeforeTouched,\n            formIsDisabled: disabled,\n            resetTouchedState: false,\n            optionsHandler: optionsHandler,\n            validationHandler: validationHandler,\n            parentContext: parentContext\n          });\n          return _extends({}, nextState);\n        });\n      }\n    }\n  }, {\n    key: \"createFormContext\",\n    value: function createFormContext() {\n      var _state2 = this.state,\n          fields = _state2.fields,\n          value = _state2.value,\n          isValid = _state2.isValid;\n      var _props4 = this.props,\n          _props4$renderer = _props4.renderer,\n          renderer = _props4$renderer === undefined ? _renderer2.default : _props4$renderer,\n          optionsHandler = _props4.optionsHandler,\n          validationHandler = _props4.validationHandler,\n          parentContext = _props4.parentContext,\n          _props4$showValidatio = _props4.showValidationBeforeTouched,\n          showValidationBeforeTouched = _props4$showValidatio === undefined ? false : _props4$showValidatio,\n          _props4$conditionalUp = _props4.conditionalUpdate,\n          conditionalUpdate = _props4$conditionalUp === undefined ? false : _props4$conditionalUp,\n          _props4$disabled = _props4.disabled,\n          disabled = _props4$disabled === undefined ? false : _props4$disabled;\n      var onFieldChange = this.onFieldChange.bind(this); // TODO: Is this creating a new function each time? Does this result in too many listeners?\n\n      var onFieldFocus = this.onFieldFocus.bind(this); // TODO: See above comment\n\n      var onFieldBlur = this.onFieldBlur.bind(this);\n      var context = {\n        fields: fields,\n        isValid: isValid,\n        value: value,\n        registerField: this.registerField.bind(this),\n        renderer: renderer,\n        optionsHandler: optionsHandler,\n        options: {},\n        onFieldBlur: onFieldBlur,\n        onFieldChange: onFieldChange,\n        onFieldFocus: onFieldFocus,\n        parentContext: parentContext,\n        showValidationBeforeTouched: showValidationBeforeTouched,\n        validationHandler: validationHandler,\n        conditionalUpdate: conditionalUpdate,\n        disabled: disabled\n      };\n      return context;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _props5 = this.props,\n          children = _props5.children,\n          defaultFields = _props5.defaultFields;\n      var fields = this.state.fields;\n      fields.forEach(function (field) {\n        if (field.pendingOptions) {\n          field.pendingOptions.then(function (options) {\n            return _this3.setState(function (prevState) {\n              return (0, _utils.setOptionsInFieldInState)(prevState, field, options);\n            });\n          });\n        }\n      });\n      var context = this.createFormContext();\n      return _react2.default.createElement(_FormContext2.default.Provider, {\n        value: context\n      }, defaultFields && _react2.default.createElement(_FormFragment2.default, {\n        defaultFields: fields\n      }), children);\n    }\n  }], [{\n    key: \"getDerivedStateFromProps\",\n    value: function getDerivedStateFromProps(nextProps, prevState) {\n      var defaultFieldsChange = defaultFieldsHaveChanged(nextProps, prevState);\n      var defaultValueChange = defaultValueHasChanged(nextProps, prevState);\n\n      if (defaultFieldsChange || valueHasChanged(nextProps, prevState) || formDisabledStateHasChanged(nextProps, prevState) || formTouchedBehaviourHasChanged(nextProps, prevState)) {\n        var fieldsFromState = prevState.fields,\n            valueFromState = prevState.value;\n        var defaultFieldsFromProps = nextProps.defaultFields,\n            valueFromProps = nextProps.value,\n            _nextProps$disabled = nextProps.disabled,\n            disabled = _nextProps$disabled === undefined ? false : _nextProps$disabled;\n        var optionsHandler = nextProps.optionsHandler,\n            validationHandler = nextProps.validationHandler,\n            parentContext = nextProps.parentContext,\n            _nextProps$showValida = nextProps.showValidationBeforeTouched,\n            showValidationBeforeTouched = _nextProps$showValida === undefined ? false : _nextProps$showValida; // If a new value has been passed to the Form as a prop then it should take precedence over the last calculated state\n\n        var value = valueFromProps || valueFromState || {};\n        var defaultFields = defaultFieldsFromProps || fieldsFromState;\n        var fields = void 0;\n\n        if (defaultFieldsFromProps && defaultFieldsChange) {\n          fields = (0, _utils.registerFields)(defaultFieldsFromProps, value);\n        } else {\n          // TODO: Ideally we shouldn't need to register to update the value...\n          fields = (0, _utils.registerFields)(fieldsFromState, value);\n        } // We should reset the touched state of all the fields if the value passed as a prop to the form\n        // changes...\n\n\n        var resetTouchedState = defaultValueChange;\n        var nextState = (0, _utils.getNextStateFromFields)({\n          fields: fields,\n          showValidationBeforeTouched: showValidationBeforeTouched,\n          formIsDisabled: disabled,\n          resetTouchedState: resetTouchedState,\n          optionsHandler: optionsHandler,\n          validationHandler: validationHandler,\n          parentContext: parentContext\n        });\n        return _extends({}, nextState, {\n          defaultFields: defaultFieldsFromProps,\n          disabled: disabled,\n          showValidationBeforeTouched: showValidationBeforeTouched\n        });\n      } else {\n        return null;\n      }\n    }\n  }]);\n\n  return Form;\n}(_react.Component);\n\nexports.default = Form;","map":{"version":3,"sources":["/Users/niharikatomar/Desktop/rr/restaurant-roulette/frontend/node_modules/react-forms-processor/dist/components/Form.js"],"names":["Object","defineProperty","exports","value","_extends","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","_createClass","defineProperties","props","descriptor","enumerable","configurable","writable","Constructor","protoProps","staticProps","_react","require","_react2","_interopRequireDefault","_isEqual","_isEqual2","_FormContext","_FormContext2","_FormFragment","_FormFragment2","_DefaultField","_DefaultField2","_utils","_renderer","_renderer2","obj","__esModule","default","_classCallCheck","instance","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","defaultFieldsHaveChanged","nextProps","prevState","defaultFields","valueHasChanged","defaultValueHasChanged","defaultValue","formDisabledStateHasChanged","disabled","undefined","formTouchedBehaviourHasChanged","showValidationBeforeTouched","Form","_Component","_this","getPrototypeOf","state","fields","isValid","shouldComponentUpdate","nextState","_props$conditionalUpd","conditionalUpdate","renderer","onFieldChange","id","skipFieldTouched","_this2","_props","optionsHandler","validationHandler","parentContext","_props$showValidation","_props$disabled","updateFieldTouchedState","updateFieldValue","getNextStateFromFields","lastFieldUpdated","formIsDisabled","resetTouchedState","setState","onChange","onFieldFocus","onFieldFocusProp","onFieldBlur","_props2","onFieldBlurProp","_props2$showValidatio","_props2$disabled","registerField","field","_state","_state$fields","_state$value","_props3","_props3$showValidatio","_props3$disabled","find","existingField","filteredFields","filter","updatedFields","concat","createFormContext","_state2","_props4","_props4$renderer","_props4$showValidatio","_props4$conditionalUp","_props4$disabled","bind","context","options","render","_this3","_props5","children","forEach","pendingOptions","then","setOptionsInFieldInState","createElement","Provider","getDerivedStateFromProps","defaultFieldsChange","defaultValueChange","fieldsFromState","valueFromState","defaultFieldsFromProps","valueFromProps","_nextProps$disabled","_nextProps$showValida","registerFields","Component"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require(\"react\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _isEqual = require(\"lodash/isEqual\");\n\nvar _isEqual2 = _interopRequireDefault(_isEqual);\n\nvar _FormContext = require(\"./FormContext\");\n\nvar _FormContext2 = _interopRequireDefault(_FormContext);\n\nvar _FormFragment = require(\"./FormFragment\");\n\nvar _FormFragment2 = _interopRequireDefault(_FormFragment);\n\nvar _DefaultField = require(\"./DefaultField\");\n\nvar _DefaultField2 = _interopRequireDefault(_DefaultField);\n\nvar _utils = require(\"../utilities/utils\");\n\nvar _renderer = require(\"../renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar defaultFieldsHaveChanged = function defaultFieldsHaveChanged(nextProps, prevState) {\n  return !(0, _isEqual2.default)(nextProps.defaultFields, prevState.defaultFields);\n};\n\nvar valueHasChanged = function valueHasChanged(nextProps, prevState) {\n  return nextProps.value && nextProps.value !== prevState.value;\n};\n\nvar defaultValueHasChanged = function defaultValueHasChanged(nextProps, prevState) {\n  return nextProps.value && nextProps.value !== prevState.defaultValue;\n};\n\nvar formDisabledStateHasChanged = function formDisabledStateHasChanged(nextProps, prevState) {\n  return nextProps.disabled !== undefined && nextProps.disabled !== prevState.disabled;\n};\n\nvar formTouchedBehaviourHasChanged = function formTouchedBehaviourHasChanged(nextProps, prevState) {\n  return nextProps.showValidationBeforeTouched !== prevState.showValidationBeforeTouched;\n};\n\nvar Form = function (_Component) {\n  _inherits(Form, _Component);\n\n  function Form(props) {\n    _classCallCheck(this, Form);\n\n    var _this = _possibleConstructorReturn(this, (Form.__proto__ || Object.getPrototypeOf(Form)).call(this, props));\n\n    _this.state = {\n      fields: [],\n      defaultValue: props.value || {},\n      value: props.value || {},\n      isValid: false,\n      defaultFields: [],\n      disabled: props.disabled || false,\n      showValidationBeforeTouched: !!props.showValidationBeforeTouched\n    };\n    return _this;\n  }\n\n  _createClass(Form, [{\n    key: \"shouldComponentUpdate\",\n    value: function shouldComponentUpdate(nextProps, nextState) {\n      var _props$conditionalUpd = this.props.conditionalUpdate,\n          conditionalUpdate = _props$conditionalUpd === undefined ? false : _props$conditionalUpd;\n      // TODO: This might need some further thought, but it definitely improves performance in the FormBuilder\n\n      if (conditionalUpdate && nextProps.renderer === this.props.renderer && (0, _isEqual2.default)(this.state.fields, nextState.fields) && (0, _isEqual2.default)(this.state.value, nextState.value)) {\n        return false;\n      }\n      return true;\n    }\n  }, {\n    key: \"onFieldChange\",\n    value: function onFieldChange(id, value, skipFieldTouched) {\n      var _this2 = this;\n\n      var _props = this.props,\n          optionsHandler = _props.optionsHandler,\n          validationHandler = _props.validationHandler,\n          parentContext = _props.parentContext,\n          _props$showValidation = _props.showValidationBeforeTouched,\n          showValidationBeforeTouched = _props$showValidation === undefined ? false : _props$showValidation,\n          _props$disabled = _props.disabled,\n          disabled = _props$disabled === undefined ? false : _props$disabled;\n      var fields = this.state.fields;\n\n      //skiping the field touch update here\n\n      if (!skipFieldTouched) {\n        fields = (0, _utils.updateFieldTouchedState)(id, true, fields);\n      }\n      fields = (0, _utils.updateFieldValue)(id, value, fields);\n      var nextState = (0, _utils.getNextStateFromFields)({\n        fields: fields,\n        lastFieldUpdated: id,\n        showValidationBeforeTouched: showValidationBeforeTouched,\n        formIsDisabled: disabled,\n        resetTouchedState: false,\n        optionsHandler: optionsHandler,\n        validationHandler: validationHandler,\n        parentContext: parentContext\n      });\n\n      this.setState(function (state, props) {\n        return nextState;\n      }, function () {\n        var onChange = _this2.props.onChange;\n        var value = nextState.value,\n            isValid = nextState.isValid;\n\n        if (onChange) {\n          onChange(value, isValid);\n        }\n      });\n    }\n  }, {\n    key: \"onFieldFocus\",\n    value: function onFieldFocus(id) {\n      // At one stage the plan was to only show validation error messages once a field\n      // had been touched, but in reality we only want to show validation messages when\n      // a field has been changed OR has been blurred.\n      // So now we just want to make sure that callbacks on the form for handling when\n      // a field is focused are called.\n      var onFieldFocusProp = this.props.onFieldFocus;\n\n      onFieldFocusProp && onFieldFocusProp(id);\n    }\n  }, {\n    key: \"onFieldBlur\",\n    value: function onFieldBlur(id) {\n      var _props2 = this.props,\n          optionsHandler = _props2.optionsHandler,\n          validationHandler = _props2.validationHandler,\n          onFieldBlurProp = _props2.onFieldBlur,\n          parentContext = _props2.parentContext,\n          _props2$showValidatio = _props2.showValidationBeforeTouched,\n          showValidationBeforeTouched = _props2$showValidatio === undefined ? false : _props2$showValidatio,\n          _props2$disabled = _props2.disabled,\n          disabled = _props2$disabled === undefined ? false : _props2$disabled;\n      var fields = this.state.fields;\n\n      fields = (0, _utils.updateFieldTouchedState)(id, true, fields);\n      var nextState = (0, _utils.getNextStateFromFields)({\n        fields: fields,\n        showValidationBeforeTouched: showValidationBeforeTouched,\n        formIsDisabled: disabled,\n        resetTouchedState: false,\n        optionsHandler: optionsHandler,\n        validationHandler: validationHandler,\n        parentContext: parentContext\n      });\n\n      this.setState(nextState, function () {\n        return onFieldBlurProp && onFieldBlurProp(id);\n      });\n    }\n\n    // Register field is provided in the context to allow children to register with this form...\n\n  }, {\n    key: \"registerField\",\n    value: function registerField(field) {\n      var _state = this.state,\n          _state$fields = _state.fields,\n          fields = _state$fields === undefined ? [] : _state$fields,\n          _state$value = _state.value,\n          value = _state$value === undefined ? {} : _state$value;\n      var _props3 = this.props,\n          _props3$showValidatio = _props3.showValidationBeforeTouched,\n          showValidationBeforeTouched = _props3$showValidatio === undefined ? false : _props3$showValidatio,\n          _props3$disabled = _props3.disabled,\n          disabled = _props3$disabled === undefined ? false : _props3$disabled;\n\n\n      if (fields.find(function (existingField) {\n        return field.id === existingField.id;\n      })) {\n        // Don't register fields twice...\n        // console.warn(\"Field ID already in use\", field.id);\n      } else {\n        fields = (0, _utils.registerField)(field, fields, value);\n        this.setState(function (state, props) {\n          var optionsHandler = props.optionsHandler,\n              validationHandler = props.validationHandler,\n              parentContext = props.parentContext;\n\n          var filteredFields = state.fields.filter(function (existingField) {\n            return existingField.id !== field.id;\n          });\n          // let updatedFields = fields.concat(filteredFields);\n          var updatedFields = filteredFields.concat(field);\n          var nextState = (0, _utils.getNextStateFromFields)({\n            fields: updatedFields,\n            showValidationBeforeTouched: showValidationBeforeTouched,\n            formIsDisabled: disabled,\n            resetTouchedState: false,\n            optionsHandler: optionsHandler,\n            validationHandler: validationHandler,\n            parentContext: parentContext\n          });\n          return _extends({}, nextState);\n        });\n      }\n    }\n  }, {\n    key: \"createFormContext\",\n    value: function createFormContext() {\n      var _state2 = this.state,\n          fields = _state2.fields,\n          value = _state2.value,\n          isValid = _state2.isValid;\n      var _props4 = this.props,\n          _props4$renderer = _props4.renderer,\n          renderer = _props4$renderer === undefined ? _renderer2.default : _props4$renderer,\n          optionsHandler = _props4.optionsHandler,\n          validationHandler = _props4.validationHandler,\n          parentContext = _props4.parentContext,\n          _props4$showValidatio = _props4.showValidationBeforeTouched,\n          showValidationBeforeTouched = _props4$showValidatio === undefined ? false : _props4$showValidatio,\n          _props4$conditionalUp = _props4.conditionalUpdate,\n          conditionalUpdate = _props4$conditionalUp === undefined ? false : _props4$conditionalUp,\n          _props4$disabled = _props4.disabled,\n          disabled = _props4$disabled === undefined ? false : _props4$disabled;\n\n      var onFieldChange = this.onFieldChange.bind(this); // TODO: Is this creating a new function each time? Does this result in too many listeners?\n      var onFieldFocus = this.onFieldFocus.bind(this); // TODO: See above comment\n      var onFieldBlur = this.onFieldBlur.bind(this);\n\n      var context = {\n        fields: fields,\n        isValid: isValid,\n        value: value,\n        registerField: this.registerField.bind(this),\n        renderer: renderer,\n        optionsHandler: optionsHandler,\n        options: {},\n        onFieldBlur: onFieldBlur,\n        onFieldChange: onFieldChange,\n        onFieldFocus: onFieldFocus,\n        parentContext: parentContext,\n        showValidationBeforeTouched: showValidationBeforeTouched,\n        validationHandler: validationHandler,\n        conditionalUpdate: conditionalUpdate,\n        disabled: disabled\n      };\n      return context;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _props5 = this.props,\n          children = _props5.children,\n          defaultFields = _props5.defaultFields;\n      var fields = this.state.fields;\n\n\n      fields.forEach(function (field) {\n        if (field.pendingOptions) {\n          field.pendingOptions.then(function (options) {\n            return _this3.setState(function (prevState) {\n              return (0, _utils.setOptionsInFieldInState)(prevState, field, options);\n            });\n          });\n        }\n      });\n\n      var context = this.createFormContext();\n      return _react2.default.createElement(\n        _FormContext2.default.Provider,\n        { value: context },\n        defaultFields && _react2.default.createElement(_FormFragment2.default, { defaultFields: fields }),\n        children\n      );\n    }\n  }], [{\n    key: \"getDerivedStateFromProps\",\n    value: function getDerivedStateFromProps(nextProps, prevState) {\n      var defaultFieldsChange = defaultFieldsHaveChanged(nextProps, prevState);\n      var defaultValueChange = defaultValueHasChanged(nextProps, prevState);\n      if (defaultFieldsChange || valueHasChanged(nextProps, prevState) || formDisabledStateHasChanged(nextProps, prevState) || formTouchedBehaviourHasChanged(nextProps, prevState)) {\n        var fieldsFromState = prevState.fields,\n            valueFromState = prevState.value;\n        var defaultFieldsFromProps = nextProps.defaultFields,\n            valueFromProps = nextProps.value,\n            _nextProps$disabled = nextProps.disabled,\n            disabled = _nextProps$disabled === undefined ? false : _nextProps$disabled;\n        var optionsHandler = nextProps.optionsHandler,\n            validationHandler = nextProps.validationHandler,\n            parentContext = nextProps.parentContext,\n            _nextProps$showValida = nextProps.showValidationBeforeTouched,\n            showValidationBeforeTouched = _nextProps$showValida === undefined ? false : _nextProps$showValida;\n\n        // If a new value has been passed to the Form as a prop then it should take precedence over the last calculated state\n\n        var value = valueFromProps || valueFromState || {};\n\n        var defaultFields = defaultFieldsFromProps || fieldsFromState;\n        var fields = void 0;\n        if (defaultFieldsFromProps && defaultFieldsChange) {\n          fields = (0, _utils.registerFields)(defaultFieldsFromProps, value);\n        } else {\n          // TODO: Ideally we shouldn't need to register to update the value...\n          fields = (0, _utils.registerFields)(fieldsFromState, value);\n        }\n\n        // We should reset the touched state of all the fields if the value passed as a prop to the form\n        // changes...\n        var resetTouchedState = defaultValueChange;\n\n        var nextState = (0, _utils.getNextStateFromFields)({\n          fields: fields,\n          showValidationBeforeTouched: showValidationBeforeTouched,\n          formIsDisabled: disabled,\n          resetTouchedState: resetTouchedState,\n          optionsHandler: optionsHandler,\n          validationHandler: validationHandler,\n          parentContext: parentContext\n        });\n        return _extends({}, nextState, {\n          defaultFields: defaultFieldsFromProps,\n          disabled: disabled,\n          showValidationBeforeTouched: showValidationBeforeTouched\n        });\n      } else {\n        return null;\n      }\n    }\n  }]);\n\n  return Form;\n}(_react.Component);\n\nexports.default = Form;"]},"metadata":{},"sourceType":"script"}